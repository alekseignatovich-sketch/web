<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Website Builder</title>
    <style>
        :root { --primary: #6366f1; --primary-hover: #4f46e5; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; background: var(--bg); color: #333; }
        .container { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #1e293b; margin-bottom: 10px; }
        p.subtitle { text-align: center; color: #64748b; margin-bottom: 30px; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #334155; }
        input, textarea { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px; box-sizing: border-box; transition: border-color 0.3s; font-family: inherit; }
        input:focus, textarea:focus { outline: none; border-color: var(--primary); }
        textarea { height: 120px; resize: vertical; }
        
        button { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: 600; transition: background 0.3s; }
        button:hover { background: var(--primary-hover); }
        button:disabled { background: #cbd5e1; cursor: not-allowed; }
        
        .loader { display: none; text-align: center; padding: 30px; }
        .spinner { width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        #result { display: none; margin-top: 30px; border-top: 2px solid #e2e8f0; padding-top: 30px; }
        .links { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; }
        .btn-link { flex: 1; text-align: center; text-decoration: none; padding: 12px 20px; border-radius: 8px; font-weight: 600; transition: opacity 0.3s; min-width: 200px; }
        .btn-repo { background: #333; color: white; }
        .btn-preview { background: #22c55e; color: white; }
        .btn-link:hover { opacity: 0.9; }
        
        .preview-container { border: 2px solid #e2e8f0; border-radius: 8px; overflow: hidden; background: white; }
        .preview-header { background: #f1f5f9; padding: 10px 15px; font-size: 14px; color: #64748b; border-bottom: 1px solid #e2e8f0; }
        iframe { width: 100%; height: 500px; border: none; display: block; }
        
        .error { background: #fef2f2; border: 1px solid #fecaca; color: #dc2626; padding: 15px; border-radius: 8px; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ AI Website Builder</h1>
        <p class="subtitle">–û–ø–∏—à–∏—Ç–µ —Å–∞–π—Ç, –∏ –ò–ò —Å–æ–∑–¥–∞—Å—Ç –µ–≥–æ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</p>
        
        <div class="form-group">
            <label for="siteName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–ª–∞—Ç–∏–Ω–∏—Ü–µ–π)</label>
            <input type="text" id="siteName" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: coffee-shop">
        </div>
        
        <div class="form-group">
            <label for="prompt">–û–ø–∏—Å–∞–Ω–∏–µ —Å–∞–π—Ç–∞</label>
            <textarea id="prompt" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ–µ–Ω–¥–∏–Ω–≥ –¥–ª—è –∫–æ—Ñ–µ–π–Ω–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞. –ú–µ–Ω—é, –∫–æ–Ω—Ç–∞–∫—Ç—ã, —Ñ–æ—Ä–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –°—Ç–∏–ª—å: –º–∏–Ω–∏–º–∞–ª–∏–∑–º, —Ç–µ–ø–ª—ã–µ —Ü–≤–µ—Ç–∞."></textarea>
        </div>
        
        <button onclick="createSite()" id="btn">‚ú® –°–æ–∑–¥–∞—Ç—å —Å–∞–π—Ç</button>
        
        <div class="loader" id="loader">
            <div class="spinner"></div>
            <h3>–ò–ò –ø–∏—à–µ—Ç –∫–æ–¥ –∏ —Ä–∏—Å—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏...</h3>
            <p style="color: #64748b;">–≠—Ç–æ –∑–∞–π–º–µ—Ç –æ–∫–æ–ª–æ 15-30 —Å–µ–∫—É–Ω–¥</p>
        </div>
        
        <div class="error" id="error"></div>
        
        <div id="result">
            <h2>‚úÖ –°–∞–π—Ç –≥–æ—Ç–æ–≤!</h2>
            <div class="links">
                <a href="#" id="repoLink" target="_blank" class="btn-link btn-repo">üìÇ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π GitHub</a>
                <a href="#" id="pageLink" target="_blank" class="btn-link btn-preview">üåê –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç</a>
            </div>
            <p style="color: #64748b; font-size: 14px;">‚ö†Ô∏è GitHub Pages –º–æ–∂–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã.</p>
            
            <div class="preview-container">
                <div class="preview-header">üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (–ª–æ–∫–∞–ª—å–Ω—ã–π)</div>
                <iframe id="previewFrame"></iframe>
            </div>
        </div>
    </div>

    <script>
        async function createSite() {
            const prompt = document.getElementById('prompt').value;
            const name = document.getElementById('siteName').value || 'ai-site';
            const btn = document.getElementById('btn');
            const loader = document.getElementById('loader');
            const result = document.getElementById('result');
            const errorDiv = document.getElementById('error');
            
            if (!prompt.trim()) {
                showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∞–π—Ç–∞");
                return;
            }

            btn.disabled = true;
            loader.style.display = 'block';
            result.style.display = 'none';
            errorDiv.style.display = 'none';

            try {
                const res = await fetch('/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ prompt, name })
                });
                
                const data = await res.json();

                if (data.success) {
                    document.getElementById('repoLink').href = data.repo;
                    document.getElementById('pageLink').href = data.preview;
                    document.getElementById('previewFrame').srcdoc = data.code;
                    result.style.display = 'block';
                } else {
                    showError(data.error || "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞");
                }
            } catch (e) {
                showError("–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º: " + e.message);
            } finally {
                btn.disabled = false;
                loader.style.display = 'none';
            }
        }

        function showError(msg) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = "‚ùå " + msg;
            errorDiv.style.display = 'block';
        }
    </script>
</body>
</html>
